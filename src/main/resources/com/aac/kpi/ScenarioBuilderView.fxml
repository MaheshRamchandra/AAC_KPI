<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.layout.Region?>

<BorderPane xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.aac.kpi.controller.ScenarioBuilderController">
    <top>
        <VBox spacing="10">
            <padding>
                <Insets top="12" right="12" bottom="12" left="12" />
            </padding>
            <children>
                <HBox spacing="10">
                    <children>
                        <Label text="KPI Type" />
                        <ComboBox fx:id="cbKpiType" prefWidth="180" promptText="Select KPI type" />
                        <Label text="Total Test Cases" />
                        <Spinner fx:id="spTotalCases" prefWidth="120" />
                    </children>
                </HBox>
                <Label text="Scenario Builder: translate each tester row into a standalone configuration. Treat every value as direct input, keep datasets isolated per row, and use the loader to avoid manual typing when possible."
                       wrapText="true" />
                <GridPane hgap="12" vgap="8">
                    <columnConstraints>
                        <ColumnConstraints minWidth="150" halignment="RIGHT" />
                        <ColumnConstraints hgrow="ALWAYS" />
                    </columnConstraints>
                    <Label text="Number of seniors" GridPane.rowIndex="0" GridPane.columnIndex="0" />
                    <TextField fx:id="tfNumberOfSeniors" GridPane.rowIndex="0" GridPane.columnIndex="1" />

                    <Label text="CFS" GridPane.rowIndex="1" GridPane.columnIndex="0" />
                    <ComboBox fx:id="cbCfs" GridPane.rowIndex="1" GridPane.columnIndex="1" editable="true" />

                    <Label text="Mode of event" GridPane.rowIndex="2" GridPane.columnIndex="0" />
                    <ComboBox fx:id="cbModeOfEvent" GridPane.rowIndex="2" GridPane.columnIndex="1" editable="true" />

                    <Label text="AAP Session Date" GridPane.rowIndex="3" GridPane.columnIndex="0" />
                    <TextField fx:id="tfAapSessionDate" GridPane.rowIndex="3" GridPane.columnIndex="1" />

                    <Label text="No of AAP attendance in person" GridPane.rowIndex="4" GridPane.columnIndex="0" />
                    <TextField fx:id="tfAapAttendance" GridPane.rowIndex="4" GridPane.columnIndex="1" />

                    <Label text="Contact logs (encounters)" GridPane.rowIndex="5" GridPane.columnIndex="0" />
                    <TextField fx:id="tfContactLogs" GridPane.rowIndex="5" GridPane.columnIndex="1" />

                    <Label text="Within or out of boundary" GridPane.rowIndex="6" GridPane.columnIndex="0" />
                    <ComboBox fx:id="cbBoundary" GridPane.rowIndex="6" GridPane.columnIndex="1" editable="true" />

                    <Label text="Purpose of contact" GridPane.rowIndex="7" GridPane.columnIndex="0" />
                    <ComboBox fx:id="cbPurpose" GridPane.rowIndex="7" GridPane.columnIndex="1" editable="true" />

                    <Label text="Date of contact" GridPane.rowIndex="8" GridPane.columnIndex="0" />
                    <TextField fx:id="tfDateOfContact" GridPane.rowIndex="8" GridPane.columnIndex="1" />

                    <Label text="Age" GridPane.rowIndex="9" GridPane.columnIndex="0" />
                    <TextField fx:id="tfAge" GridPane.rowIndex="9" GridPane.columnIndex="1" />

                    <Label text="Remarks / Others" GridPane.rowIndex="10" GridPane.columnIndex="0" />
                    <TextArea fx:id="taRemarks" GridPane.rowIndex="10" GridPane.columnIndex="1" prefRowCount="3" wrapText="true" />

                    <Label text="Custom columns (key=value, one per line)" GridPane.rowIndex="11" GridPane.columnIndex="0" />
                    <TextArea fx:id="taCustomExtras" GridPane.rowIndex="11" GridPane.columnIndex="1" prefRowCount="3" wrapText="true"
                              promptText="Example:&#10;Social Risk Factor=>1&#10;KPI Type=Befriending" />
                </GridPane>
                <HBox spacing="10">
                    <children>
                        <Button text="Load from Excel" onAction="#onLoadFromExcel" />
                        <Button text="Add Scenario" onAction="#onAddScenario" />
                        <Button text="Add Column" onAction="#onAddColumnOverride" />
                        <Button text="Remove Column" onAction="#onRemoveColumnOverride" />
                        <Button text="Remove Selected" onAction="#onRemoveSelected" />
                        <Button text="Reset Fields" onAction="#onResetForm" />
                    </children>
                </HBox>
            </children>
        </VBox>
    </top>
    <center>
        <TableView fx:id="table" prefHeight="360.0">
            <columns>
                <TableColumn fx:id="cKpi" text="KPI" prefWidth="120" />
                <TableColumn fx:id="cSeniors" text="Number of seniors" prefWidth="140" />
                <TableColumn fx:id="cCfs" text="CFS" prefWidth="80" />
                <TableColumn fx:id="cMode" text="Mode of event" prefWidth="120" />
                <TableColumn fx:id="cAapDate" text="AAP Session Date" prefWidth="120" />
                <TableColumn fx:id="cAapAttendance" text="AAP Attendance" prefWidth="120" />
                <TableColumn fx:id="cIsAttended" text="Is Attended" prefWidth="120" />
                <TableColumn fx:id="cTotalRegistration" text="Total registration" prefWidth="140" />
                <TableColumn fx:id="cContactLogs" text="Contact logs" prefWidth="120" />
                <TableColumn fx:id="cBoundary" text="Boundary" prefWidth="140" />
                <TableColumn fx:id="cPurpose" text="Purpose of contact" prefWidth="180" />
                <TableColumn fx:id="cContactDate" text="Date of contact" prefWidth="120" />
                <TableColumn fx:id="cEncounterStart" text="Encounter start" prefWidth="140" />
                <TableColumn fx:id="cAge" text="Age" prefWidth="80" />
                <TableColumn fx:id="cPatientBirthdate" text="Patient birthdate" prefWidth="150" />
                <TableColumn fx:id="cReportingMonth" text="Reporting month" prefWidth="150" />
                <TableColumn fx:id="cReportDate" text="Date" prefWidth="120" />
                <TableColumn fx:id="cSocialRisk" text="Social risk score" prefWidth="140" />
                <TableColumn fx:id="cBuddyStart" text="Buddying period start" prefWidth="160" />
                <TableColumn fx:id="cBuddyEnd" text="Buddying period end" prefWidth="160" />
                <TableColumn fx:id="cBefriendingStart" text="Befriending period start" prefWidth="180" />
                <TableColumn fx:id="cBefriendingEnd" text="Befriending period end" prefWidth="180" />
                <TableColumn fx:id="cRemarks" text="Remarks / Others" prefWidth="200" />
                <TableColumn fx:id="cOverrides" text="Column overrides" prefWidth="260" />
            </columns>
        </TableView>
    </center>
    <bottom>
        <HBox spacing="10">
            <padding>
                <Insets top="8" right="8" bottom="8" left="8" />
            </padding>
            <children>
                <Label fx:id="summaryLabel" text="0 scenarios defined" />
                <Region HBox.hgrow="ALWAYS" />
                <Button text="Generate Excel" onAction="#onGenerateExcel" />
            </children>
        </HBox>
    </bottom>
</BorderPane>
